//function img_check(a,b,c,d,e,f,g,h,i,j,k){var l=$("#"+j).val();a=$("#"+f),this.AllowExt=".jpg,.gif,.jpeg,.png,.pjpeg",this.FileExt=a.val().substr(a.val().lastIndexOf(".")).toLowerCase(),0!=this.AllowExt&&-1==this.AllowExt.indexOf(this.FileExt)?$("#"+g).text("只支持jpg、gif、png、jpeg格式，请重新上传").show():($("#"+g).text("").hide(),$.ajaxFileUpload({url:b,secureuri:!1,fileElementId:f,data:{type:l,myfiles:a.val()},dataType:"text",success:function(a){""!=a?($("#"+k).val(a),$("#"+i+" img").attr("src",ctx+"/"+a),$("#"+h).hide(),$("#"+i).show()):$("#"+g).text("上传失败，请重新上传").show()},error:function(){$("#"+g).text("上传失败，请重新上传").show()}}))}$(function(){$("#addMember").click(function(){var a=$(".formWrapper").length,b=$("#companyId").val();2==a&&$(this).hide(),$("#memberDiv").append('<div class="formWrapper"><input type="hidden" name="leaderInfos['+a+'].companyId" value="'+b+'" />'+'<div class="new_portrait">'+'<div id="portraitNo'+a+'" class="portrait_upload">'+"<span>上传创始人头像</span>"+"</div>"+'<div  id="portraitShow'+a+'" class="portraitShow dn">'+'<img src="" width="120" height="120" />'+"<span>更换头像</span>"+"</div>"+'<input type="file" class="myfiles" id="myfiles'+a+'" name="myfiles" onchange="img_check(this,\''+ctx+"/c/upload.json',120,120,5,'myfiles"+a+"','myfiles"+a+"_error','portraitNo"+a+"','portraitShow"+a+"','type"+a+"','leaderInfos"+a+'\');" title="支持jpg、jpeg、gif、png格式，文件小于5M" />'+'<input type="hidden" id="type'+a+'" name="type'+a+'" value="7" />'+'<input type="hidden" id="leaderInfos'+a+'" name="leaderInfos['+a+'].photo" />'+'<em>  尺寸：120*120px <br />  大小：小于5M</em><span class="error" id="myfiles'+a+'_error" style="display:none;"></span></div>'+"<h3>创始人姓名</h3>"+'<input type="text" class="s_input1" id="name'+a+'" name="leaderInfos['+a+'].name" placeholder="请输入创始人姓名" />'+"<h3>当前职位</h3>"+'<input type="text" class="s_input1" id="position'+a+'" name="leaderInfos['+a+'].position" placeholder="请输入当前职位，如：创始人兼CEO" />'+"<h3>新浪微博</h3>"+'<input type="text" id="weibo'+a+'" name="leaderInfos['+a+'].weibo" placeholder="请输入新浪微博地址" />'+"<h3>创始人简介</h3>"+'<textarea class="s_textarea" id="description'+a+'" name="leaderInfos['+a+'].remark" maxlength="1000" placeholder="请输入该创始人的个人履历等，建议按照时间倒序分条展示"></textarea>'+'<div class="word_count">你还可以输入 <span>500</span> 字</div>'+"</div>"),$(".formWrapper").each(function(b){b!=a&&$(this).css({borderBottom:"1px solid #555",paddingBottom:"20px"})})}),$("#memberDiv").on("keyup","textarea",function(){var a=$(this);a.val().length>500?a.val(a.val().substring(0,500)):a.siblings(".word_count").children("span").text(500-a.val().length)}),$("#memberForm").on("mouseenter",".new_portrait input",function(){$(".portrait_upload").css("backgroundColor","#7e9597")}),$("#memberForm").on("mouseleave",".new_portrait input",function(){$(".portrait_upload").css("backgroundColor","#e7e7e7")}),$("#memberForm").validate({onkeyup:!1,focusCleanup:!0,rules:{"leaderInfos[0].name":{required:!1,specialchar:!0,checkNum:!0,minlength:2,maxlenStr:20},"leaderInfos[0].position":{required:!1,specialchar:!0,checkNum:!0,maxlenStr:60},"leaderInfos[0].weibo":{required:!1,checkUrlNot:!0,maxlength:120},"leaderInfos[0].remark":{required:!1,checkNum:!0,minlength:10,maxlength:500},"leaderInfos[1].name":{required:!1,specialchar:!0,checkNum:!0,minlength:2,maxlenStr:20},"leaderInfos[1].position":{required:!1,specialchar:!0,checkNum:!0,maxlenStr:60},"leaderInfos[1].weibo":{required:!1,checkUrl:!0,maxlength:120},"leaderInfos[1].remark":{required:!1,checkNum:!0,minlength:10,maxlength:500},"leaderInfos[2].name":{required:!1,specialchar:!0,checkNum:!0,minlength:2,maxlenStr:20},"leaderInfos[2].position":{required:!1,specialchar:!0,checkNum:!0,maxlenStr:60},"leaderInfos[2].weibo":{required:!1,checkUrlNot:!0,maxlength:120},"leaderInfos[2].remark":{required:!1,checkNum:!0,minlength:10,maxlength:500}},messages:{"leaderInfos[0].name":{specialchar:"请输入真实的创始人姓名",checkNum:"请输入真实的创始人姓名",minlength:"请输入真实的创始人姓名",maxlenStr:"请输入真实的创始人姓名"},"leaderInfos[0].position":{specialchar:"请输入真实的当前职位",checkNum:"请输入真实的当前职位",maxlenStr:"请输入真实的当前职位"},"leaderInfos[0].weibo":{checkUrlNot:"请输入真实的新浪微博地址",maxlength:"请输入120字符以内的网址"},"leaderInfos[0].remark":{checkNum:"请输入有效的个人简介",minlength:"请输入10-500字的个人简介",maxlength:"请输入10-500字的个人简介"},"leaderInfos[1].name":{specialchar:"请输入真实的创始人姓名",checkNum:"请输入真实的创始人姓名",minlength:"请输入真实的创始人姓名",maxlenStr:"请输入真实的创始人姓名"},"leaderInfos[1].position":{specialchar:"请输入真实的当前职位",checkNum:"请输入真实的当前职位",maxlenStr:"请输入真实的当前职位"},"leaderInfos[1].weibo":{checkUrlNot:"请输入真实的新浪微博地址",maxlength:"请输入120字符以内的网址"},"leaderInfos[1].remark":{checkNum:"请输入有效的个人简介",minlength:"请输入10-500字的个人简介",maxlength:"请输入10-500字的个人简介"},"leaderInfos[2].name":{specialchar:"请输入真实的创始人姓名",checkNum:"请输入真实的创始人姓名",minlength:"请输入真实的创始人姓名",maxlenStr:"请输入真实的创始人姓名"},"leaderInfos[2].position":{specialchar:"请输入真实的当前职位",checkNum:"请输入真实的当前职位",maxlenStr:"请输入真实的当前职位"},"leaderInfos[2].weibo":{checkUrlNot:"请输入真实的新浪微博地址",maxlength:"请输入120字符以内的网址"},"leaderInfos[2].remark":{checkNum:"请输入有效的个人简介",minlength:"请输入10-500字的个人简介",maxlength:"请输入10-500字的个人简介"}},submitHandler:function(a){var b=$(a).find('input[type="text"]'),c=$(a).find("textarea");b.each(function(){$(this).val()==$(this).attr("placeholder")&&$(this).val("")}),c.each(function(){$(this).text()==$(this).attr("placeholder")&&$(this).text("")}),$(a).find(":submit").attr("disabled",!0),a.submit()}})});
/**
 * 企业用户填写公司信息
 * 第三步：
 *      公司创始人信息
 */

//点击下一步按钮，触发的事件
$("#hiddenSubmit").click(function () {
    //获取公司ID
    var companyId=$("#companyId").val();
    //获取公司创始人人数
    var count=$(".formWrapper").length;
    //console.log("创始人人数："+count);
    //将总人数存入表单隐藏域中
    $("#count").val(count);

    //获取创始人姓名0
    var name0=$("#name0").val();
    //获取创始人头像0
    var Photo0=$("#select_btn0").attr("src");
    //获取职位0
    var position0=$("#position0").val();
    //获取简介0
    var describe0=$("#description0").val();

    //获取创始人姓名1
    var name1=$("#name1").val();
    //获取创始人头像1
    var Photo1=$("#select_btn1").attr("src");
    //获取职位1
    var position1=$("#position1").val();
    //获取简介1
    var describe1=$("#description1").val();

    //获取创始人姓名2
    var name2=$("#name2").val();
    //获取创始人头像2
    var Photo2=$("#select_btn2").attr("src");
    //获取职位2
    var position2=$("#position2").val();
    //获取简介2
    var describe2=$("#description2").val();

    // console.log("公司ID："+companyId);
    // console.log("总人数："+count);
    //
    // console.log("获取创始人姓名0"+name0);
    // console.log("获取创始人头像0"+Photo0);
    // console.log("获取职位0"+position0);
    // console.log("获取简介0"+describe0);
    //
    // console.log("获取创始人姓名1"+name1);
    // console.log("获取创始人头像1"+Photo1);
    // console.log("获取职位1"+position1);
    // console.log("获取简介1"+describe1);
    //
    // console.log("获取创始人姓名2"+name2);
    // console.log("获取创始人头像2"+Photo2);
    // console.log("获取职位2"+position2);
    // console.log("获取简介2"+describe2);

    //获取当前登陆用户ID
    var userId=$("#userId").val();
    //判断用户是否登陆
    if(userId==""||userId==null){
        layer.alert("请前往登陆！",function () {
            location.href="/loginPage";
        });
        return false;
    }

    if(count==1){
        //只有一人
        if(name0==""||name0==null){
            layer.alert("请输入姓名！",{icon:2});
            return false;
        }
        if(Photo0=="style/images/upload_Photo.png"){
            layer.alert("请上传头像！",{icon:2});
            return false;
        }
        if(position0==""||position0==null){
            layer.alert("请输入职称！",{icon:2});
            return false;
        }
        if(describe0==""||describe0==null){
            layer.alert("请输入简介！",{icon:2});
            return false;
        }
    }
    if(count==2){
        //有两人
        if((name2==null||name2=="")&&(Photo2==null||Photo2=="")&&(position2==null||position2=="")&&(describe2==null||describe2=="")){
            //填写了第二个人的信息
            if(name0==""||name0==null||name1==""||name1==null){
                layer.alert("请输入姓名！",{icon:2});
                return false;
            }
            if(Photo0=="style/images/upload_Photo.png"||Photo1=="style/images/upload_Photo.png"){
                layer.alert("请上传头像！",{icon:2});
                return false;
            }
            if(position0==""||position0==null||position1==""||position1==null){
                layer.alert("请输入职称！",{icon:2});
                return false;
            }
            if(describe0==""||describe0==null||describe1==""||describe1==null){
                layer.alert("请输入简介！",{icon:2});
                return false;
            }
        }
        if((name1==null||name1=="")&&(Photo1==null||Photo1=="")&&(position1==null||position1=="")&&(describe1==null||describe1=="")){
            //填写了第三个人的信息
            if(name0==""||name0==null||name2==""||name2==null){
                layer.alert("请输入姓名！",{icon:2});
                return false;
            }
            if(Photo0=="style/images/upload_Photo.png"||Photo2=="style/images/upload_Photo.png"){
                layer.alert("请上传头像！",{icon:2});
                return false;
            }
            if(position0==""||position0==null||position2==""||position2==null){
                layer.alert("请输入职称！",{icon:2});
                return false;
            }
            if(describe0==""||describe0==null||describe2==""||describe2==null){
                layer.alert("请输入简介！",{icon:2});
                return false;
            }
        }

    }
    if(count==3){
        //有三人
        if(name0==""||name0==null||name1==""||name1==null||name2==""||name2==null){
            layer.alert("请输入所有人的姓名！",{icon:2});
            return false;
        }
        if(Photo0=="style/images/upload_Photo.png"||Photo1=="style/images/upload_Photo.png"||Photo2=="style/images/upload_Photo.png"){
            layer.alert("请上传所有人的头像！",{icon:2});
            return false;
        }
        if(position0==""||position0==null||position1==""||position1==null||position2==""||position2==null){
            layer.alert("请输入所有人的职称！",{icon:2});
            return false;
        }
        if(describe0==""||describe0==null||describe1==""||describe1==null||describe2==""||describe2==null){
            layer.alert("请输入所有人的简介！",{icon:2});
            return false;
        }
    }

    //信息填写完毕，请求后端
    $("#step3Submit").click();
});

