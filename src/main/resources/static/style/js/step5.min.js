//$(function(){$("#infoForm").on("keyup","textarea",function(){var a=$(this),b=$.trim(a.val()).length;b>1e3?a.val(a.val().substring(0,1e3)):$(this).siblings("span").length>0&&(b>20||20==b)?$(this).siblings("span").hide():$(this).siblings("span").length>0&&20>b?$(this).siblings("span").show():a.next(".word_count").children("span").text(1e3-b)}),$("#step5Submit").click(function(){$("#infoForm").submit()}),$("#infoForm").submit(function(){$("textarea",this).val()==$("textarea",this).attr("placeholder")&&$("textarea",this).val("")}).validate({onkeyup:!1,rules:{companyProfile:{required:!1,specialchar:!0,checkNum:!0,rangeLen:[20,1e3]}},messages:{companyProfile:{specialchar:"请输入有效的公司介绍",checkNum:"请输入有效的公司介绍",rangeLen:"请输入20-1000字的公司介绍"}},submitHandler:function(a){$(a).find(":submit").attr("disabled",!0),a.submit()}})});
/**
 * 企业用户填写公司信息
 * 第五步：
 *      填写公司介绍
 */

//点击完成按钮触发事件
$("#step5Submit").click(function () {
    //获取公司介绍
    var companyDescribe = $("#companyProfile").val();
    //获取公司ID
    var companyId = $("#companyId").val();
    //获取当前登陆用户ID
    var userId = $("#userId").val();

    if (companyId == "" || companyId == null || userId == "" || userId == null) {
        layer.msg("权限不足！");
        return false;
    }
    if (companyDescribe == "" || companyDescribe == null) {
        layer.msg("请输入公司简介！");
        return false;
    }

    //数据校验成功，向后端发送请求
    $.ajax({
        type: "post",
        url: "/saveCompanyDescribe/" + companyId + "/" + userId + "/" + companyDescribe,
        success: function (result) {
            //成功的回调函数
            if (result.code == 0) {
                //公司介绍信息插入成功
                //layer.msg("公司介绍信息插入成功!");
                location.href = "/success";
                return false;
            } else if (result.code == 1) {
                //公司介绍信息插入失败
                layer.msg("公司介绍信息插入失败,请稍后再试");
                return false;
            } else {
                layer.msg("系统繁忙,请稍后再试");
                return false;
            }

        }
    });


});